(self.webpackChunkmap_observer=self.webpackChunkmap_observer||[]).push([[659],{914:(H,k,a)=>{"use strict";a.d(k,{r:()=>z});var t=a(457),g=a(655),e=a(2382),T=a(5092),F=a(6565),P=a(4987),x=a(8372),n=a(5e3),p=a(9889),D=a(9808);function J(A,_){if(1&A&&(n.TgZ(0,"option",15),n._uU(1),n.qZA()),2&A){const u=_.$implicit;n.Q6J("value",u.type),n.xp6(1),n.hij(" ",u.label," ")}}let d=class{constructor(_,u){this.formBuilder=_,this.activeModal=u,this.asset=void 0,this.form=this.formBuilder.group({}),this.assetTypeOptions=T.wA}ngOnInit(){var _,u;this.buildForm(),null===(_=this.form.get("isCountUndefined"))||void 0===_||_.valueChanges.pipe((0,x.b)(0),(0,P.t)(this)).subscribe(M=>{const Z=this.form.value.count;M&&void 0!==Z&&this.form.patchValue({count:void 0}),!M&&null==Z&&this.form.patchValue({count:0})}),null===(u=this.form.get("count"))||void 0===u||u.valueChanges.pipe((0,x.b)(0),(0,P.t)(this)).subscribe(M=>{void 0!==M&&this.form.value.isCountUndefined&&this.form.patchValue({isCountUndefined:!1})})}buildForm(){var _,u,M,Z;this.form=this.formBuilder.group({description:[(null===(_=this.asset)||void 0===_?void 0:_.description)||"",e.kI.required],count:[(null===(u=this.asset)||void 0===u?void 0:u.count)||void 0],isCountUndefined:[void 0===(null===(M=this.asset)||void 0===M?void 0:M.count)],type:[(null===(Z=this.asset)||void 0===Z?void 0:Z.type)||T.h3.Technic,e.kI.required]})}onCancel(){this.activeModal.dismiss()}onSubmit(){var _,u,M,Z,U,I,q,j;if(null===(_=this.form)||void 0===_?void 0:_.valid){const X={id:(null===(u=this.asset)||void 0===u?void 0:u.id)||void 0,description:null===(Z=null===(M=this.form)||void 0===M?void 0:M.value)||void 0===Z?void 0:Z.description,count:null===(I=null===(U=this.form)||void 0===U?void 0:U.value)||void 0===I?void 0:I.count,type:null===(j=null===(q=this.form)||void 0===q?void 0:q.value)||void 0===j?void 0:j.type};this.activeModal.close(X)}}isNewAsset(){return!this.asset||!(0,F.s)(this.asset)}};d.\u0275fac=function(_){return new(_||d)(n.Y36(e.qu),n.Y36(p.Kz))},d.\u0275cmp=n.Xpm({type:d,selectors:[["app-asset-form"]],inputs:{asset:"asset"},decls:31,vars:4,consts:[[1,"modal-header"],[1,"modal-title"],[1,"modal-body"],["novalidate","",3,"formGroup"],["for","asset-description"],["id","asset-description","formControlName","description",1,"form-control","ml-1"],["for","asset-type"],["formControlName","type","id","asset-type",1,"form-control","ml-1"],[3,"value",4,"ngFor","ngForOf"],["for","asset-count"],["type","checkbox","formControlName","isCountUndefined"],["type","number","id","asset-count","formControlName","count",1,"form-control","ml-1"],[1,"modal-footer"],["type","button",1,"btn","btn-link",3,"click"],["type","button",1,"btn","btn-primary",3,"disabled","click"],[3,"value"]],template:function(_,u){1&_&&(n.TgZ(0,"div",0),n.TgZ(1,"h4",1),n.TgZ(2,"span"),n._uU(3," \u0410\u043a\u0442\u0438\u0432 "),n.qZA(),n.qZA(),n.qZA(),n.TgZ(4,"div",2),n.TgZ(5,"form",3),n.TgZ(6,"div"),n.TgZ(7,"h5"),n.TgZ(8,"label",4),n._uU(9,"\u041e\u043f\u0438\u0441"),n.qZA(),n.qZA(),n._UZ(10,"textarea",5),n.qZA(),n.TgZ(11,"div"),n.TgZ(12,"h5"),n.TgZ(13,"label",6),n._uU(14,"\u0422\u0438\u043f"),n.qZA(),n.qZA(),n.TgZ(15,"select",7),n.YNc(16,J,2,2,"option",8),n.qZA(),n.qZA(),n.TgZ(17,"div"),n.TgZ(18,"h3"),n.TgZ(19,"label",9),n._uU(20,"\u041a\u0456\u043b\u044c\u043a\u0456\u0441\u0442\u044c"),n.qZA(),n.qZA(),n.TgZ(21,"div"),n._UZ(22,"input",10),n.TgZ(23,"span"),n._uU(24,"\u041d\u0435\u0432\u0456\u0434\u043e\u043c\u043e"),n.qZA(),n.qZA(),n._UZ(25,"input",11),n.qZA(),n.qZA(),n.qZA(),n.TgZ(26,"div",12),n.TgZ(27,"button",13),n.NdJ("click",function(){return u.onCancel()}),n._uU(28," \u0432\u0456\u0434\u0431\u0456\u0439 "),n.qZA(),n.TgZ(29,"button",14),n.NdJ("click",function(){return u.onSubmit()}),n._uU(30),n.qZA(),n.qZA()),2&_&&(n.xp6(5),n.Q6J("formGroup",u.form),n.xp6(11),n.Q6J("ngForOf",u.assetTypeOptions),n.xp6(13),n.Q6J("disabled",!u.form.valid),n.xp6(1),n.hij(" ",u.isNewAsset()?"\u0414\u043e\u0434\u0430\u0442\u0438":"\u0417\u043c\u0456\u043d\u0438\u0442\u0438"," "))},directives:[e._Y,e.JL,e.sg,e.Fj,e.JJ,e.u,e.EJ,D.sg,e.Wl,e.wV,e.YN,e.Kr],styles:[""],changeDetection:0}),d=(0,g.gn)([(0,P.c)()],d);var s=a(7319),h=a(561),f=a(1135),C=a(4004),O=a(9841),w=a(5698),E=(()=>{return(A=E||(E={}))[A.None=0]="None",A[A.Entities=1]="Entities",E;var A})();function N(A){return function(u,M){const Z={entities:Object.assign({},M.entities)};return A(u,Z)===E.Entities?Object.assign(Object.assign({},M),{entities:Z.entities}):M}}function B(A,_){return!(!_||!_.entities[A])}var r=a(1829);function y(A,_){if(1&A){const u=n.EpF();n.TgZ(0,"app-asset-view",10),n.NdJ("click",function(){const U=n.CHM(u).$implicit,I=n.oxw().ngIf;return n.oxw().select(U.id,!!I[U.id])}),n.qZA()}if(2&A){const u=_.$implicit,M=n.oxw().ngIf;n.ekj("selected",M[u.id]),n.Q6J("asset",u)}}function m(A,_){if(1&A&&(n.TgZ(0,"div"),n.YNc(1,y,1,3,"app-asset-view",9),n.ALo(2,"async"),n.qZA()),2&A){const u=n.oxw();n.xp6(1),n.Q6J("ngForOf",n.lcZ(2,1,u.assets$))}}let b=(()=>{class A{constructor(u,M){this.activeModal=u,this.store=M,this.selectedAdapter=function R(A){const _=function G(){return{getInitialState:function A(_={}){return Object.assign({entities:{}},_)}}}(),u=function $(){return{getSelectors:function A(_){const u=U=>U.entities,M=(0,s.P1)(u,U=>Object.keys(U)),Z=(0,s.P1)(M,U=>U.length);return _?{selectIds:(0,s.P1)(_,M),selectEntities:(0,s.P1)(_,u),selectTotal:(0,s.P1)(_,Z)}:{selectIds:M,selectEntities:u,selectTotal:Z}}}}(),M=function Q(){function A(I,q){return I in q.entities?E.None:(q.entities[I]=!0,E.Entities)}function Z(I,q){let j=!1;for(const X of I)X in q.entities&&(delete q.entities[X],j=!0);return j?E.Entities:E.None}return{addOne:N(A),addMany:N(function _(I,q){let j=E.None;for(const X of I)j=A(X,q)||j;return j}),addAll:N(function u(I,q){return q.entities=I.reduce((j,X)=>(j[X]=!0,j),{}),E.Entities}),removeOne:N(function M(I,q){return Z([I],q)}),removeMany:N(Z),removeAll:function U(I){return Object.assign({},I,{entities:{}})}}}();return Object.assign(Object.assign(Object.assign(Object.assign({},_),u),M),{hasId:B})}(),this.selectedSelectors=this.selectedAdapter.getSelectors(),this.selectedState$=new f.X(this.selectedAdapter.getInitialState()),this.selected$=this.selectedState$.pipe((0,C.U)(this.selectedSelectors.selectEntities)),this.selectedIds$=this.selectedState$.pipe((0,C.U)(this.selectedSelectors.selectIds)),this.assets$=this.store.pipe((0,s.Ys)(h.q.selectAssetsAll))}ngOnInit(){}onCancel(){this.activeModal.dismiss()}onSubmit(){(0,O.a)([this.store.pipe((0,s.Ys)(h.q.selectAssetsEntities)),this.selectedIds$]).pipe((0,w.q)(1)).subscribe(([u,M])=>{this.activeModal.close(M.map(Z=>u[Z]))})}select(u,M){let Z=this.selectedState$.value;Z=M?this.selectedAdapter.removeOne(u,Z):this.selectedAdapter.addOne(u,Z),this.selectedState$.next(Z)}}return A.\u0275fac=function(u){return new(u||A)(n.Y36(p.Kz),n.Y36(s.yh))},A.\u0275cmp=n.Xpm({type:A,selectors:[["app-select-asset-modal"]],decls:16,vars:6,consts:[[1,"modal-header"],[1,"modal-title"],[1,"modal-body"],[1,"text-secondary"],[1,"items-list"],[4,"ngIf"],[1,"modal-footer"],["type","button",1,"btn","btn-link",3,"click"],["type","button",1,"btn","btn-primary",3,"disabled","click"],[3,"asset","selected","click",4,"ngFor","ngForOf"],[3,"asset","click"]],template:function(u,M){if(1&u&&(n.TgZ(0,"div",0),n.TgZ(1,"h4",1),n.TgZ(2,"span"),n._uU(3," \u041e\u0431\u0435\u0440\u0456\u0442\u044c \u0410\u043a\u0442\u0438\u0432\u0438 "),n.qZA(),n.qZA(),n.qZA(),n.TgZ(4,"div",2),n.TgZ(5,"h6",3),n._uU(6,"\u043c\u043e\u0436\u043d\u0430 \u043e\u0431\u0440\u0430\u0442\u0438 \u043e\u0434\u0438\u043d \u0430\u0431\u043e \u043a\u0456\u043b\u044c\u043a\u0430 \u0430\u043a\u0442\u0438\u0432\u0456\u0432"),n.qZA(),n.TgZ(7,"div",4),n.YNc(8,m,3,3,"div",5),n.ALo(9,"async"),n.qZA(),n.qZA(),n.TgZ(10,"div",6),n.TgZ(11,"button",7),n.NdJ("click",function(){return M.onCancel()}),n._uU(12," \u0432\u0456\u0434\u0431\u0456\u0439 "),n.qZA(),n.TgZ(13,"button",8),n.NdJ("click",function(){return M.onSubmit()}),n.ALo(14,"async"),n._uU(15," \u041f\u0456\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u0438 "),n.qZA(),n.qZA()),2&u){let Z;n.xp6(8),n.Q6J("ngIf",n.lcZ(9,2,M.selected$)),n.xp6(5),n.Q6J("disabled",!(null!=(Z=n.lcZ(14,4,M.selectedIds$))&&Z.length))}},directives:[D.O5,D.sg,r.F],pipes:[D.Ov],styles:[".selected[_ngcontent-%COMP%]{background-color:#0d6efd}.items-list[_ngcontent-%COMP%]{max-height:400px;overflow:auto}"],changeDetection:0}),A})(),z=(()=>{class A{constructor(u){this.modalService=u,this.openedModal=null}addAsset(){var u;return null===(u=this.openedModal)||void 0===u||u.close(),this.openedModal=this.modalService.open(d,{keyboard:!1,backdrop:"static",size:"lg"}),(0,t.D)(this.openedModal.result)}editAsset(u){var M;return null===(M=this.openedModal)||void 0===M||M.close(),this.openedModal=this.modalService.open(d,{keyboard:!1,backdrop:"static",size:"lg"}),this.openedModal.componentInstance.asset=Object.assign({},u),(0,t.D)(this.openedModal.result)}selectAsset(){var u;return null===(u=this.openedModal)||void 0===u||u.close(),this.openedModal=this.modalService.open(b,{keyboard:!1,backdrop:"static",size:"lg"}),(0,t.D)(this.openedModal.result)}}return A.\u0275fac=function(u){return new(u||A)(n.LFG(p.FF))},A.\u0275prov=n.Yz7({token:A,factory:A.\u0275fac,providedIn:"root"}),A})()},543:(H,k,a)=>{"use strict";a.d(k,{W:()=>B});var t=a(5e3),g=a(7213),e=a(9808),F=a(808);let P=(()=>{class r{constructor(m,b){this.el=m,this.toastsService=b,this.value=void 0,this.successMessage=void 0,this.hiddenTextArea=null}onClick(){this.init(),this.select(),this.notify(),this.destroy()}ngOnInit(){this.el.nativeElement.setAttribute("style","cursor: pointer")}init(){this.hiddenTextArea=document.createElement("textarea"),this.hiddenTextArea.setAttribute("readonly",""),this.hiddenTextArea.className="",this.hiddenTextArea.value=this.value||"",this.hiddenTextArea.className="copy-to-clipboard-hidden-element",document.body.appendChild(this.hiddenTextArea)}select(){var m;null===(m=this.hiddenTextArea)||void 0===m||m.select(),document.execCommand("copy")}notify(){this.successMessage&&this.toastsService.success(this.successMessage)}destroy(){this.hiddenTextArea&&(document.body.removeChild(this.hiddenTextArea),this.hiddenTextArea=null)}}return r.\u0275fac=function(m){return new(m||r)(t.Y36(t.SBq),t.Y36(F.kl))},r.\u0275dir=t.lG2({type:r,selectors:[["","drsClipboard",""]],hostBindings:function(m,b){1&m&&t.NdJ("click",function(){return b.onClick()})},inputs:{value:"value",successMessage:"successMessage"}}),r})();function x(r,y){if(1&r&&(t.TgZ(0,"span",2),t._uU(1),t.TgZ(2,"span",3),t._uU(3,"\u0441\u043a\u043e\u043f\u0456\u044e\u0432\u0430\u0442\u0438"),t.qZA(),t.qZA()),2&r){const m=t.oxw();t.Q6J("value",m.getCoordinatesString())("successMessage","\u0421\u043a\u043e\u043f\u0456\u0439\u043e\u0432\u0430\u043d\u043e"),t.xp6(1),t.lnq(" ",m.coord[1],"\xa0",m.coord[0],"\xa0",m.coord[2]," ")}}function n(r,y){1&r&&t._uU(0,"\u043d\u0435\u0432\u0456\u0434\u043e\u043c\u043e")}let p=(()=>{class r{constructor(){this.coord=void 0}ngOnInit(){}getCoordinatesString(){return this.coord?function T(r){if(null==r?void 0:r.length){let y=`${r[1]} ${r[0]}`;return r[2]?y+" "+r[2]:y}return""}(this.coord):""}}return r.\u0275fac=function(m){return new(m||r)},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-geo-coordinates"]],inputs:{coord:"coord"},decls:3,vars:2,consts:[["drsClipboard","",3,"value","successMessage",4,"ngIf","ngIfElse"],["noCoordinates",""],["drsClipboard","",3,"value","successMessage"],[1,"text-secondary","size-xs"]],template:function(m,b){if(1&m&&(t.YNc(0,x,4,5,"span",0),t.YNc(1,n,1,0,"ng-template",null,1,t.W1O)),2&m){const z=t.MAs(2);t.Q6J("ngIf",b.coord)("ngIfElse",z)}},directives:[e.O5,P],styles:["[_nghost-%COMP%]{overflow:hidden;white-space:normal;text-overflow:ellipsis;word-break:break-all}"],changeDetection:0}),r})();function D(r,y){if(1&r&&(t.TgZ(0,"div"),t._UZ(1,"app-asset-movement-short",2),t.qZA()),2&r){const m=t.oxw();t.xp6(1),t.Q6J("geo",m.asFeature().geometry)("selectedPosition",m.selectedPosition)}}function J(r,y){if(1&r&&(t.TgZ(0,"div"),t._UZ(1,"app-geo-coordinates",4),t.qZA()),2&r){const m=y.$implicit,b=t.oxw(2);t.xp6(1),t.ekj("selected",b.isSelected(m)),t.Q6J("coord",m)}}function d(r,y){if(1&r&&(t.TgZ(0,"div"),t.YNc(1,J,2,3,"div",3),t.qZA()),2&r){const m=t.oxw();let b;t.xp6(1),t.Q6J("ngForOf",null==(b=m.asMultiPoint())?null:b.coordinates)}}function s(r,y){if(1&r&&(t.TgZ(0,"div"),t._UZ(1,"app-geo-coordinates",4),t.qZA()),2&r){const m=y.$implicit;t.xp6(1),t.Q6J("coord",m)}}function h(r,y){if(1&r&&(t.TgZ(0,"div"),t.YNc(1,s,2,1,"div",3),t.qZA()),2&r){const m=y.$implicit;t.xp6(1),t.Q6J("ngForOf",m)}}function f(r,y){if(1&r&&(t.TgZ(0,"div"),t.YNc(1,h,2,1,"div",3),t.qZA()),2&r){const m=t.oxw();let b;t.xp6(1),t.Q6J("ngForOf",null==(b=m.asPolygon())?null:b.coordinates)}}function C(r,y){if(1&r&&(t.TgZ(0,"div"),t._UZ(1,"app-geo-coordinates",4),t.qZA()),2&r){const m=y.$implicit;t.xp6(1),t.Q6J("coord",m)}}function O(r,y){if(1&r&&(t.TgZ(0,"div"),t.YNc(1,C,2,1,"div",3),t.qZA()),2&r){const m=t.oxw();let b;t.xp6(1),t.Q6J("ngForOf",null==(b=m.asLineString())?null:b.coordinates)}}let w=(()=>{class r{constructor(){this.GeoJsonType=g.jN,this.geo=void 0}ngOnInit(){}asFeature(){return null==this?void 0:this.geo}asMultiPoint(){return null==this?void 0:this.geo}asLineString(){return null==this?void 0:this.geo}asPolygon(){return null==this?void 0:this.geo}isSelected(m){return!!this.selectedPosition&&m[0]===this.selectedPosition[0]&&m[1]===this.selectedPosition[1]}}return r.\u0275fac=function(m){return new(m||r)},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-asset-movement-short"]],inputs:{geo:"geo",selectedPosition:"selectedPosition"},decls:5,vars:5,consts:[[3,"ngSwitch"],[4,"ngSwitchCase"],[3,"geo","selectedPosition"],[4,"ngFor","ngForOf"],[3,"coord"]],template:function(m,b){1&m&&(t.TgZ(0,"div",0),t.YNc(1,D,2,2,"div",1),t.YNc(2,d,2,1,"div",1),t.YNc(3,f,2,1,"div",1),t.YNc(4,O,2,1,"div",1),t.qZA()),2&m&&(t.Q6J("ngSwitch",null==b.geo?null:b.geo.type),t.xp6(1),t.Q6J("ngSwitchCase",b.GeoJsonType.Feature),t.xp6(1),t.Q6J("ngSwitchCase",b.GeoJsonType.MultiPoint),t.xp6(1),t.Q6J("ngSwitchCase",b.GeoJsonType.Polygon),t.xp6(1),t.Q6J("ngSwitchCase",b.GeoJsonType.LineString))},directives:[e.RF,e.n9,r,e.sg,p],styles:[".selected[_ngcontent-%COMP%]{background-color:#198754aa}"],changeDetection:0}),r})();var Y=a(3897),G=a(8010);function $(r,y){1&r&&(t.ynx(0),t._uU(1,"\u0434\u043e \u0442\u0435\u043f\u0435\u0440"),t.BQk())}function E(r,y){if(1&r&&(t._uU(0),t.ALo(1,"date")),2&r){const m=t.oxw(2);t.Oqu(t.Dn7(1,1,m.date,m.DateTimeFormatShort,m.UkraineTimeZone))}}function N(r,y){if(1&r&&(t.TgZ(0,"span"),t.YNc(1,$,2,0,"ng-container",0),t.YNc(2,E,2,5,"ng-template",null,2,t.W1O),t.qZA()),2&r){const m=t.MAs(3),b=t.oxw();t.xp6(1),t.Q6J("ngIf",b.isTillToday())("ngIfElse",m)}}function Q(r,y){1&r&&(t.TgZ(0,"span"),t._uU(1,"\u0434\u0430\u043d\u0438\u0445 \u043d\u0435\u043c\u0430"),t.qZA())}let R=(()=>{class r{constructor(){this.date=void 0,this.UkraineTimeZone=Y.wy,this.DateTimeFormatShort=Y.Ap}ngOnInit(){}isTillToday(){return(0,G.c)(this.date)}}return r.\u0275fac=function(m){return new(m||r)},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-data-time"]],inputs:{date:"date"},decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["undef",""],["definedData",""]],template:function(m,b){if(1&m&&(t.YNc(0,N,4,2,"span",0),t.YNc(1,Q,2,0,"ng-template",null,1,t.W1O)),2&m){const z=t.MAs(2);t.Q6J("ngIf",!!b.date)("ngIfElse",z)}},directives:[e.O5],pipes:[e.uU],styles:[""],changeDetection:0}),r})(),B=(()=>{class r{constructor(){this.showOnMap=new t.vpe}ngOnInit(){}}return r.\u0275fac=function(m){return new(m||r)},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-asset-movement"]],inputs:{movement:"movement",selectedPosition:"selectedPosition"},outputs:{showOnMap:"showOnMap"},decls:10,vars:5,consts:[[1,"p-1","col-12"],[1,"row","m-0"],[1,"p-1","text-secondary","col-md-6"],[3,"geo","selectedPosition"],[1,"p-1","col-md-6"],[3,"date"]],template:function(m,b){1&m&&(t.TgZ(0,"div",0),t._uU(1),t.qZA(),t.TgZ(2,"div",1),t.TgZ(3,"div",2),t._UZ(4,"app-asset-movement-short",3),t.qZA(),t.TgZ(5,"div",4),t._UZ(6,"app-data-time",5),t.TgZ(7,"span"),t._uU(8,"\xa0-\xa0"),t.qZA(),t._UZ(9,"app-data-time",5),t.qZA(),t.qZA()),2&m&&(t.xp6(1),t.hij(" ",null==b.movement?null:b.movement.description,"\n"),t.xp6(3),t.Q6J("geo",null==b.movement?null:b.movement.geo)("selectedPosition",b.selectedPosition),t.xp6(2),t.Q6J("date",null==b.movement?null:b.movement.start),t.xp6(3),t.Q6J("date",null==b.movement?null:b.movement.end))},directives:[w,R],styles:[""],changeDetection:0}),r})()},4741:(H,k,a)=>{"use strict";a.d(k,{Y:()=>n});var t=a(9808),g=a(5e3);let e=(()=>{class p{}return p.\u0275fac=function(J){return new(J||p)},p.\u0275mod=g.oAB({type:p}),p.\u0275inj=g.cJS({imports:[[t.ez]]}),p})(),T=(()=>{class p{}return p.\u0275fac=function(J){return new(J||p)},p.\u0275mod=g.oAB({type:p}),p.\u0275inj=g.cJS({imports:[[t.ez]]}),p})(),F=(()=>{class p{}return p.\u0275fac=function(J){return new(J||p)},p.\u0275mod=g.oAB({type:p}),p.\u0275inj=g.cJS({imports:[[t.ez,T]]}),p})(),P=(()=>{class p{}return p.\u0275fac=function(J){return new(J||p)},p.\u0275mod=g.oAB({type:p}),p.\u0275inj=g.cJS({imports:[[t.ez,F]]}),p})(),x=(()=>{class p{}return p.\u0275fac=function(J){return new(J||p)},p.\u0275mod=g.oAB({type:p}),p.\u0275inj=g.cJS({imports:[[t.ez]]}),p})(),n=(()=>{class p{}return p.\u0275fac=function(J){return new(J||p)},p.\u0275mod=g.oAB({type:p}),p.\u0275inj=g.cJS({imports:[[t.ez,e,P,x]]}),p})()},1829:(H,k,a)=>{"use strict";a.d(k,{F:()=>e});var t=a(5092),g=a(5e3);let e=(()=>{class T{constructor(){}ngOnInit(){}getAssetLabel(P){return!!P&&t.vb[P]||""}isCountUnknown(P){return null==P}}return T.\u0275fac=function(P){return new(P||T)},T.\u0275cmp=g.Xpm({type:T,selectors:[["app-asset-view"]],inputs:{asset:"asset"},decls:7,vars:3,consts:[[1,"row"],[1,"col-sm-8","col-md-9","p-1"],[1,"col-sm-4","col-md-3","p-1"],[1,"col-sm-6","p-1"]],template:function(P,x){1&P&&(g.TgZ(0,"div",0),g.TgZ(1,"div",1),g._uU(2),g.qZA(),g.TgZ(3,"div",2),g._uU(4),g.qZA(),g.TgZ(5,"div",3),g._uU(6),g.qZA(),g.qZA()),2&P&&(g.xp6(2),g.hij(" ",null==x.asset?null:x.asset.description," "),g.xp6(2),g.Oqu(x.getAssetLabel(null==x.asset?null:x.asset.type)),g.xp6(2),g.Oqu(x.isCountUnknown(null==x.asset?null:x.asset.count)?"\u043a\u0456\u043b\u044c\u043a\u0456\u0441\u0442\u044c \u043d\u0435\u0432\u0456\u0434\u043e\u043c\u0430":null==x.asset?null:x.asset.count))},styles:["[_nghost-%COMP%]{display:block}.row[_ngcontent-%COMP%]{margin:0}"],changeDetection:0}),T})()},8796:(H,k,a)=>{"use strict";a.d(k,{o:()=>e});var t=a(9808),g=a(5e3);let e=(()=>{class T{}return T.\u0275fac=function(P){return new(P||T)},T.\u0275mod=g.oAB({type:T}),T.\u0275inj=g.cJS({imports:[[t.ez]]}),T})()},7213:(H,k,a)=>{"use strict";a.d(k,{S0:()=>T,c7:()=>e,jN:()=>t,k5:()=>g});var t=(()=>{return(F=t||(t={})).MultiPoint="MultiPoint",F.LineString="LineString",F.Polygon="Polygon",F.Feature="Feature",F.MultiPolygon="MultiPolygon",F.GeometryCollection="GeometryCollection",t;var F})();const g={type:t.MultiPoint,label:"\u041a\u043e\u043e\u0440\u0434\u0438\u043d\u0430\u0442\u0438"},e={type:t.LineString,label:"\u041b\u0456\u043d\u0456\u044f"},T={type:t.Polygon,label:"\u041f\u043e\u043b\u0456\u0433\u043e\u043d"}},9792:(H,k,a)=>{"use strict";a.d(k,{a:()=>ut});var t=a(457),g=a(5815),e=a(5e3),T=a(9889),F=a(7319),P=a(655),x=a(4987),n=a(2382);function p(c,o){if(o.length<c)throw new TypeError(c+" argument"+(c>1?"s":"")+" required, but only "+o.length+" present")}function D(c){p(1,arguments);var o=Object.prototype.toString.call(c);return c instanceof Date||"object"==typeof c&&"[object Date]"===o?new Date(c.getTime()):"number"==typeof c||"[object Number]"===o?new Date(c):(("string"==typeof c||"[object String]"===o)&&"undefined"!=typeof console&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://git.io/fjule"),console.warn((new Error).stack)),new Date(NaN))}var _,d=a(8010),s=a(3897),h=a(6567),f=a(5698),C=a(8505),O=a(5816),w=a(8407),G=(a(7637),a(2937)),$=a(1135),E=a(7579),N=a(9300),Q=a(3900),R=a(9841),B=a(8372),r=a(4004),y=a(1365),m=a(7213),b=a(9761),z=a(1359),A=a(9808);let u=_=class extends b.H{constructor(o,i){super(i),this.formBuilder=o,this.form=this.formBuilder.group({}),this.submitChange$=new E.x}ngOnInit(){this.buildForm(),this.submitChange$.pipe((0,B.b)(10),(0,x.t)(this)).subscribe(()=>{this.form.valid&&(this.value=function Z(c){const o=c.split(/[,\s]+/);if(2===o.length)return{lat:Number.parseFloat(o[0]),lng:Number.parseFloat(o[1])}}(this.form.value.latlng))})}buildForm(){this.form=this.formBuilder.group({latlng:[M(this.value),n.kI.required]})}onSubmit(){this.submitChange$.next()}writeValue(o){super.writeValue(o),this.form.patchValue({latlng:M(this.value)})}};function M(c){return c?`${c.lat} ${c.lng}`:""}var U;u.\u0275fac=function(o){return new(o||u)(e.Y36(n.qu),e.Y36(e.sBO))},u.\u0275cmp=e.Xpm({type:u,selectors:[["app-lat-lng-edit"]],features:[e._Bn([{provide:n.JU,useExisting:(0,e.Gpc)(()=>_),multi:!0}]),e.qOj],decls:4,vars:1,consts:[["novalidate","",1,"d-flex","flex-row",3,"formGroup","ngSubmit","keyup.enter"],["type","text","formControlName","latlng",1,"form-control","m-1","flex-grow-1",3,"blur"],[1,"btn","btn-link",3,"click"]],template:function(o,i){1&o&&(e.TgZ(0,"form",0),e.NdJ("ngSubmit",function(){return i.onSubmit()})("keyup.enter",function(){return i.onSubmit()}),e.TgZ(1,"input",1),e.NdJ("blur",function(){return i.onSubmit()}),e.qZA(),e.TgZ(2,"button",2),e.NdJ("click",function(){return i.onSubmit()}),e._uU(3,"\u0437\u043c\u0456\u043d\u0438\u0442\u0438"),e.qZA(),e.qZA()),2&o&&e.Q6J("formGroup",i.form)},directives:[n._Y,n.JL,n.sg,n.Fj,n.JJ,n.u],styles:[""],changeDetection:0}),u=_=(0,P.gn)([(0,x.c)()],u);const I=["map"];function q(c,o){if(1&c&&(e.TgZ(0,"option",10),e._uU(1),e.qZA()),2&c){const i=o.$implicit;e.Q6J("value",i.type),e.xp6(1),e.hij(" ",i.label," ")}}function j(c,o){if(1&c){const i=e.EpF();e.TgZ(0,"div",11),e.TgZ(1,"app-lat-lng-edit",12),e.NdJ("ngModelChange",function(v){const V=e.CHM(i).index;return e.oxw().changeMarker(v,V)}),e.qZA(),e.TgZ(2,"button",13),e.NdJ("click",function(){const S=e.CHM(i).index;return e.oxw().removeMarker(S)}),e._uU(3,"X"),e.qZA(),e.qZA()}if(2&c){const i=o.$implicit;e.xp6(1),e.Q6J("ngModel",i)}}const X={radius:3,fillColor:"#ff7800",color:"#000",weight:1,opacity:1,fillOpacity:.8};let K=U=class extends b.H{constructor(o){super(o),this.pointOfInterest={coordinates:G.E,zoom:G.T},this.pointOfInterestChange=new e.vpe,this.geoValue$=new $.X(tt(m.jN.MultiPoint,[])),this.geoType$=this.geoValue$.pipe((0,r.U)(i=>{var l;return null===(l=null==i?void 0:i.geometry)||void 0===l?void 0:l.type})),this.markerCoordinates$=this.geoValue$.pipe((0,r.U)(i=>!!i&&function st(c){var o;switch(null===(o=null==c?void 0:c.geometry)||void 0===o?void 0:o.type){case"LineString":case"MultiPoint":return c.geometry.coordinates.map(nt);case"Polygon":return c.geometry.coordinates[0].map(nt)}return[]}(i)||[])),this.map$=new $.X(null),this.geoJsonLayer$=new $.X(null),this.markers$=new $.X([]),this.reloadMarkers$=new E.x,this.arrowHeadsLayer$=new $.X([]),this.arrowHeadsLines$=this.geoValue$.pipe((0,r.U)(i=>(0,z.UW)([i]))),this.geoTypeOptions=[m.k5,m.c7,m.S0]}setGeoType(o){this.markerCoordinates$.pipe((0,f.q)(1)).subscribe(i=>{const l=tt(o,i.map(W));l&&this.geoValue$.next(l)})}ngOnInit(){this.map$.pipe((0,N.h)(o=>!!o),(0,Q.w)(o=>(0,R.a)([this.markerCoordinates$,this.markers$]).pipe((0,r.U)(([i,l])=>({coordinates:i,markers:l,mapObj:o})))),(0,x.t)(this)).subscribe(({coordinates:o,markers:i,mapObj:l})=>{if(l)if(i.length!==o.length)if(i.length<o.length){const v=Array.from(Array(o.length-i.length)).map(()=>this.createMarker(l));this.markers$.next([...i,...v])}else i.slice(o.length).forEach(v=>{v.remove()}),this.markers$.next(i.slice(0,o.length));else o.forEach((v,S)=>{i[S].setLatLng(v)})}),this.reloadMarkers$.pipe((0,y.M)(this.markers$,this.geoType$),(0,x.t)(this)).subscribe(([,o,i])=>{const l=tt(i,o.map(it));l&&this.geoValue$.next(l)}),this.map$.pipe((0,N.h)(o=>!!o),(0,Q.w)(o=>this.markerCoordinates$),(0,f.q)(1)).subscribe(o=>{(null==o?void 0:o.length)||(this.addMarker(),this.changeDetectorRef.detectChanges())}),this.map$.pipe((0,N.h)(o=>!!o),(0,Q.w)(()=>this.geoValue$),(0,y.M)(this.geoJsonLayer$),(0,x.t)(this)).subscribe(([o,i])=>{null==i||i.clearLayers(),o&&(null==i||i.addData(o),this.value=o,this.touch(),this.changeDetectorRef.markForCheck())}),this.map$.pipe((0,N.h)(o=>!!o),(0,Q.w)(o=>(0,R.a)([this.arrowHeadsLines$,this.arrowHeadsLayer$]).pipe((0,r.U)(([i,l])=>({lines:i,heads:l,mapObj:o})))),(0,x.t)(this)).subscribe(({lines:o,heads:i,mapObj:l})=>{if(l)if(i.length!==o.length)if(i.length<o.length){const v=Array.from(Array(o.length-i.length)).map((S,V)=>(0,z.Cl)(l));this.arrowHeadsLayer$.next([...i,...v])}else i.slice(o.length).forEach(v=>{v.remove()}),this.arrowHeadsLayer$.next(i.slice(0,o.length));else o.forEach((v,S)=>{i[S].setPaths(v)})}),this.geoValue$.pipe((0,N.h)(o=>!!o),(0,B.b)(250),(0,f.q)(1),(0,y.M)(this.map$)).subscribe(([o,i])=>{const l=function rt(c){switch(null==c?void 0:c.geometry.type){case"Point":return[c.geometry.coordinates];case"MultiPoint":case"LineString":return c.geometry.coordinates;case"Polygon":return c.geometry.coordinates.flat()}return[]}(o);if(l.length&&i){const v=new w.LatLngBounds([]);l.forEach(S=>{v.extend((0,z.re)(S))}),i.fitBounds(v,{maxZoom:12})}})}ngOnDestroy(){this.map$.pipe((0,f.q)(1)).subscribe(o=>{o&&this.pointOfInterestChange.emit({coordinates:(0,z.re)(W(o.getCenter())),zoom:o.getZoom()})})}ngAfterViewInit(){var o;const i=w.map(null===(o=this.mapElement)||void 0===o?void 0:o.nativeElement);this.pointOfInterest&&i.setView(this.pointOfInterest.coordinates,this.pointOfInterest.zoom),w.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:20,minZoom:3,attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'}).addTo(i);const v=w.geoJSON(void 0,{pointToLayer:(S,V)=>w.circleMarker(V,X),onEachFeature(S,V){}});v.setStyle(S=>({color:(null==S?void 0:S.properties.color)||"#ffffff"})),this.geoJsonLayer$.next(v),v.addTo(i),this.map$.next(i)}addMarker(){this.markerCoordinates$.pipe((0,f.q)(1),(0,y.M)(this.geoType$,this.map$)).subscribe(([o,i,l])=>{if(l){const v=tt(i,[...o.map(W),W(l.getCenter())]);v&&this.geoValue$.next(v)}})}recreateMarkers(){this.geoType$.pipe((0,f.q)(1),(0,y.M)(this.map$)).subscribe(([o,i])=>{if(i){const l=tt(o,[W(i.getCenter())]);l&&this.geoValue$.next(l)}})}changeMarker(o,i){this.markerCoordinates$.pipe((0,f.q)(1),(0,y.M)(this.geoType$,this.map$)).subscribe(([l,v,S])=>{if(S){(l=[...l])[i]=o;const V=tt(v,l.map(W));V&&this.geoValue$.next(V)}})}removeMarker(o){this.markerCoordinates$.pipe((0,f.q)(1),(0,y.M)(this.geoType$,this.map$)).subscribe(([i,l,v])=>{if(v){(i=[...i]).splice(o,1);const S=tt(l,i.map(W));S&&this.geoValue$.next(S)}})}createMarker(o){const i=w.marker(o.getCenter(),{draggable:!0,autoPan:!0}).addTo(o);return i.on("dragend",l=>{this.reloadMarkers()}),i}reloadMarkers(){this.reloadMarkers$.next()}writeValue(o){this.geoValue$.next(o),super.writeValue(o)}};function W(c){return[c.lng,c.lat]}function nt(c){return{lat:c[1],lng:c[0]}}function it(c){return W(c.getLatLng())}function tt(c,o){switch(c){case"LineString":return{type:"Feature",geometry:{type:"LineString",coordinates:o},properties:{}};case"Polygon":return{type:"Feature",geometry:{type:"Polygon",coordinates:[o]},properties:{}};default:return{type:"Feature",geometry:{type:"MultiPoint",coordinates:o},properties:{}}}return null}K.\u0275fac=function(o){return new(o||K)(e.Y36(e.sBO))},K.\u0275cmp=e.Xpm({type:K,selectors:[["app-map-selection-view"]],viewQuery:function(o,i){if(1&o&&e.Gf(I,5),2&o){let l;e.iGM(l=e.CRH())&&(i.mapElement=l.first)}},inputs:{pointOfInterest:"pointOfInterest"},outputs:{pointOfInterestChange:"pointOfInterestChange"},features:[e._Bn([{provide:n.JU,useExisting:(0,e.Gpc)(()=>U),multi:!0}]),e.qOj],decls:14,vars:7,consts:[[1,"form-control","ml-1","my-2",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[1,"my-2"],[1,"btn","btn-outline-primary",3,"click"],[1,"btn","btn-outline-warning",3,"click"],["class","d-flex flex-row",4,"ngFor","ngForOf"],[1,"map-container"],[1,"map-frame"],[1,"map"],["map",""],[3,"value"],[1,"d-flex","flex-row"],[1,"flex-grow-1",3,"ngModel","ngModelChange"],[1,"btn","btn-outline-secondary",3,"click"]],template:function(o,i){1&o&&(e.TgZ(0,"select",0),e.NdJ("ngModelChange",function(v){return i.setGeoType(v)}),e.ALo(1,"async"),e.YNc(2,q,2,2,"option",1),e.qZA(),e.TgZ(3,"div",2),e.TgZ(4,"button",3),e.NdJ("click",function(){return i.addMarker()}),e._uU(5,"\u0434\u043e\u0434\u0430\u0442\u0438 \u043c\u0430\u0440\u043a\u0435\u0440"),e.qZA(),e.TgZ(6,"button",4),e.NdJ("click",function(){return i.recreateMarkers()}),e._uU(7,"\u043e\u0447\u0438\u0441\u0442\u0438\u0442\u0438 \u043c\u0430\u0440\u043a\u0435\u0440\u0438"),e.qZA(),e.qZA(),e.YNc(8,j,4,1,"div",5),e.ALo(9,"async"),e.TgZ(10,"div",6),e.TgZ(11,"div",7),e._UZ(12,"div",8,9),e.qZA(),e.qZA()),2&o&&(e.Q6J("ngModel",e.lcZ(1,3,i.geoType$)),e.xp6(2),e.Q6J("ngForOf",i.geoTypeOptions),e.xp6(6),e.Q6J("ngForOf",e.lcZ(9,5,i.markerCoordinates$)))},directives:[n.EJ,n.JJ,n.On,A.sg,n.YN,n.Kr,u],pipes:[A.Ov],styles:[".map[_ngcontent-%COMP%]{width:100%;height:500px}"],changeDetection:0}),K=U=(0,P.gn)([(0,x.c)()],K);const at=["startDate"],lt=["endDate"];let et=class{constructor(o,i){this.formBuilder=o,this.store=i,this.form=this.formBuilder.group({}),this.onChange=new e.vpe,this.pointOfInterest$=this.store.pipe((0,F.Ys)(h.N$.selectPointOfInterest),(0,f.q)(1),(0,C.b)(console.error.bind(null,"p")))}ngOnInit(){this.buildForm(),this.form.valueChanges.pipe((0,x.t)(this)).subscribe(o=>{var i;if(this.form.valid){const l=(0,s.wG)(o.startDate,o.startTime)||new Date;let v=(0,s.wG)(o.endDate,o.endTime)||null;v&&function J(c,o){p(2,arguments);var i=D(c),l=D(o);return i.getTime()<l.getTime()}(v,l)&&(v=l);const S={id:this.movement&&(0,g._)(this.movement)?null===(i=this.movement)||void 0===i?void 0:i.id:void 0,description:o.description,start:l.getTime(),end:v?v.getTime():d.w,geo:o.geo};this.onChange.next(S)}})}pointOfInterestChange(o){this.store.dispatch((0,O.Z)({point:o}))}buildForm(){var o,i,l,v,S,V;this.form=this.formBuilder.group({description:[(null===(o=this.movement)||void 0===o?void 0:o.description)||"",null],startDate:[(0,s.yq)(null===(i=this.movement)||void 0===i?void 0:i.start)||null,n.kI.required],startTime:[(0,s.mr)(null===(l=this.movement)||void 0===l?void 0:l.start)||null],endDate:[(0,s.yq)(null===(v=this.movement)||void 0===v?void 0:v.end)||null],endTime:[(0,s.mr)(null===(S=this.movement)||void 0===S?void 0:S.end)||null],geo:[(null===(V=this.movement)||void 0===V?void 0:V.geo)||void 0,n.kI.required]})}};et.\u0275fac=function(o){return new(o||et)(e.Y36(n.qu),e.Y36(F.yh))},et.\u0275cmp=e.Xpm({type:et,selectors:[["app-add-edit-movement"]],viewQuery:function(o,i){if(1&o&&(e.Gf(at,5),e.Gf(lt,5)),2&o){let l;e.iGM(l=e.CRH())&&(i.startDate=l.first),e.iGM(l=e.CRH())&&(i.endDate=l.first)}},inputs:{movement:"movement"},outputs:{onChange:"onChange"},decls:28,vars:4,consts:[["novalidate","",3,"formGroup"],[1,"mb-3"],["for","asset-description"],["id","asset-description","formControlName","description",1,"form-control","ml-1"],[1,"d-flex","flex-row"],[1,"flex-grow-0"],["placeholder","\u0440\u0456\u043a-\u043c\u0456\u0441\u044f\u0446-\u0434\u0435\u043d\u044c","formControlName","startDate","type","text","ngbDatepicker","",3,"click"],["startDate","ngbDatepicker"],["placeholder","\u0433\u043e\u0434\u0438\u043d\u0430:\u0445\u0432","formControlName","startTime","type","text"],["placeholder","\u0440\u0456\u043a-\u043c\u0456\u0441\u044f\u0446-\u0434\u0435\u043d\u044c","formControlName","endDate","type","text","ngbDatepicker","",3,"click"],["endDate","ngbDatepicker"],["placeholder","\u0433\u043e\u0434\u0438\u043d\u0430:\u0445\u0432","formControlName","endTime","type","text"],["formControlName","geo",3,"pointOfInterest","pointOfInterestChange"]],template:function(o,i){if(1&o){const l=e.EpF();e.TgZ(0,"form",0),e.TgZ(1,"div",1),e.TgZ(2,"h5"),e.TgZ(3,"label",2),e._uU(4,"\u041e\u043f\u0438\u0441"),e.qZA(),e.qZA(),e._UZ(5,"textarea",3),e.qZA(),e.TgZ(6,"div",1),e.TgZ(7,"div"),e.TgZ(8,"h3"),e._uU(9,"\u043f\u043e\u0447\u0430\u0442\u043e\u043a"),e.qZA(),e.TgZ(10,"div",4),e.TgZ(11,"div",5),e.TgZ(12,"input",6,7),e.NdJ("click",function(){return e.CHM(l),e.MAs(13).toggle()}),e.qZA(),e.qZA(),e.TgZ(14,"div",5),e._UZ(15,"input",8),e.qZA(),e.qZA(),e.qZA(),e.TgZ(16,"div"),e.TgZ(17,"h3"),e._uU(18,"\u0437\u0430\u043a\u0456\u043d\u0447\u0435\u043d\u043d\u044f (\u043e\u043f\u0446\u0456\u043e\u043d\u0430\u043b\u044c\u043d\u043e)"),e.qZA(),e.TgZ(19,"div",4),e.TgZ(20,"div",5),e.TgZ(21,"input",9,10),e.NdJ("click",function(){return e.CHM(l),e.MAs(22).toggle()}),e.qZA(),e.qZA(),e.TgZ(23,"div",5),e._UZ(24,"input",11),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(25,"div"),e.TgZ(26,"app-map-selection-view",12),e.NdJ("pointOfInterestChange",function(S){return i.pointOfInterestChange(S)}),e.ALo(27,"async"),e.qZA(),e.qZA(),e.qZA()}2&o&&(e.Q6J("formGroup",i.form),e.xp6(26),e.Q6J("pointOfInterest",e.lcZ(27,2,i.pointOfInterest$)))},directives:[n._Y,n.JL,n.sg,n.Fj,n.JJ,n.u,T.J4,K],pipes:[A.Ov],styles:[""],changeDetection:0}),et=(0,P.gn)([(0,x.c)()],et);let ot=(()=>{class c{constructor(i,l){this.activeModal=i,this.store=l,this.movement=void 0}ngOnInit(){}onCancel(){this.activeModal.dismiss()}onSubmit(){this.activeModal.close(this.movement)}onChange(i){this.movement=i}isNewMovement(){return!this.movement||!(0,g._)(this.movement)}}return c.\u0275fac=function(i){return new(i||c)(e.Y36(T.Kz),e.Y36(F.yh))},c.\u0275cmp=e.Xpm({type:c,selectors:[["app-movement-form-modal"]],inputs:{movement:"movement"},decls:11,vars:2,consts:[[1,"modal-header"],[1,"modal-title"],[1,"modal-body"],[3,"movement","onChange"],[1,"modal-footer"],["type","button",1,"btn","btn-link",3,"click"],["type","button",1,"btn","btn-primary",3,"click"]],template:function(i,l){1&i&&(e.TgZ(0,"div",0),e.TgZ(1,"h4",1),e.TgZ(2,"span"),e._uU(3," \u041f\u0435\u0440\u0435\u043c\u0456\u0449\u0435\u043d\u043d\u044f "),e.qZA(),e.qZA(),e.qZA(),e.TgZ(4,"div",2),e.TgZ(5,"app-add-edit-movement",3),e.NdJ("onChange",function(S){return l.onChange(S)}),e.qZA(),e.qZA(),e.TgZ(6,"div",4),e.TgZ(7,"button",5),e.NdJ("click",function(){return l.onCancel()}),e._uU(8," \u0432\u0456\u0434\u0431\u0456\u0439 "),e.qZA(),e.TgZ(9,"button",6),e.NdJ("click",function(){return l.onSubmit()}),e._uU(10),e.qZA(),e.qZA()),2&i&&(e.xp6(5),e.Q6J("movement",l.movement),e.xp6(5),e.hij(" ",l.isNewMovement()?"\u0414\u043e\u0434\u0430\u0442\u0438":"\u0417\u043c\u0456\u043d\u0438\u0442\u0438"," "))},directives:[et],styles:[""],changeDetection:0}),c})(),ut=(()=>{class c{constructor(i){this.modalService=i,this.openedModal=null}addMovement(){var i;return null===(i=this.openedModal)||void 0===i||i.close(),this.openedModal=this.modalService.open(ot,{keyboard:!1,backdrop:"static",size:"lg"}),(0,t.D)(this.openedModal.result)}editMovement(i){var l;return null===(l=this.openedModal)||void 0===l||l.close(),this.openedModal=this.modalService.open(ot,{keyboard:!1,backdrop:"static",size:"lg"}),this.openedModal.componentInstance.movement=i,(0,t.D)(this.openedModal.result)}}return c.\u0275fac=function(i){return new(i||c)(e.LFG(T.FF))},c.\u0275prov=e.Yz7({token:c,factory:c.\u0275fac,providedIn:"root"}),c})()},5092:(H,k,a)=>{"use strict";a.d(k,{h3:()=>t,vb:()=>e,wA:()=>g});var t=(()=>{return(T=t||(t={})).Technic="technic",T.Combat="combat",T.Soldiers="soldiers",T.BlockPost="blockpost",T.ExpensiveTech="exptech",T.HQ="hq",t;var T})();const g=[{type:t.Combat,label:"\u0431\u043e\u0439\u043e\u0432\u0456 \u043f\u043e\u0437\u0438\u0446\u0456\u0457"},{type:t.Soldiers,label:"\u041e\u0441\u043e\u0431\u043e\u0432\u0438\u0439 \u0441\u043a\u043b\u0430\u0434"},{type:t.BlockPost,label:"\u0411\u043b\u043e\u043a \u041f\u043e\u0441\u0442"},{type:t.Technic,label:"\u0442\u0435\u0445\u043d\u0456\u043a\u0430"},{type:t.ExpensiveTech,label:"\u0426\u0456\u043d\u043d\u0430 \u0442\u0435\u0445\u043d\u0456\u043a\u0430"},{type:t.HQ,label:"\u0428\u0442\u0430\u0431"}],e=g.reduce((T,F)=>(T[F.type]=F.label,T),{})},8010:(H,k,a)=>{"use strict";a.d(k,{c:()=>g,w:()=>t});const t=Number.MAX_SAFE_INTEGER;function g(e){return e===t}},3897:(H,k,a)=>{"use strict";a.d(k,{Ap:()=>F,U5:()=>T,mr:()=>P,wG:()=>n,wy:()=>e,yq:()=>x});var t=a(8010),g=a(9808);const e="+03:00",T="HH:mm dd-MM-YYYY",F="HH:mm dd/MM";function P(p){return p&&!(0,t.c)(p)?(0,g.p6)(p,"HH:mm","en",e):null}function x(p){return p&&!(0,t.c)(p)?{year:Number.parseInt((0,g.p6)(p,"YYYY","en",e)),day:Number.parseInt((0,g.p6)(p,"dd","en",e)),month:Number.parseInt((0,g.p6)(p,"MM","en",e))}:null}function n(p,D){return p?D?new Date(`${p.year}-${p.month}-${p.day} ${D}:00${e}`):new Date(`${p.year}-${p.month}-${p.day} 00:00${e}`):null}},7637:function(H,k,a){!function(t){"use strict";t=t&&t.hasOwnProperty("default")?t.default:t;var e=function(s,h){return(180*Math.atan2(h.y-s.y,h.x-s.x)/Math.PI+90+360)%360},T=function(s,h){var f=s.value;return s.isInPixels?f/h:f};function F(d){if("string"==typeof d&&-1!==d.indexOf("%"))return{value:parseFloat(d)/100,isInPixels:!1};var s=d?parseFloat(d):0;return{value:s,isInPixels:s>0}}var d,s,h;function x(d){return d.reduce(function(s,h,f,C){if(f>0&&!function(s,h){return s.x===h.x&&s.y===h.y}(h,C[f-1])){var O=C[f-1],w=s.length>0?s[s.length-1].distB:0,Y=function g(d,s){var h=s.x-d.x,f=s.y-d.y;return Math.sqrt(h*h+f*f)}(O,h);s.push({a:O,b:h,distA:w,distB:w+Y,heading:e(O,h)})}return s},[])}function p(d,s,h){return s.x!==d.x?{x:d.x+h*(s.x-d.x),y:d.y+h*(s.y-d.y)}:{x:d.x,y:d.y+(s.y-d.y)*h}}d=L.Marker.prototype._initIcon,s=L.Marker.prototype._setPos,h="msTransform"===L.DomUtil.TRANSFORM,L.Marker.addInitHook(function(){var C=this.options.icon&&this.options.icon.options&&this.options.icon.options.iconAnchor;C&&(C=C[0]+"px "+C[1]+"px"),this.options.rotationOrigin=this.options.rotationOrigin||C||"center bottom",this.options.rotationAngle=this.options.rotationAngle||0,this.on("drag",function(O){O.target._applyRotation()})}),L.Marker.include({_initIcon:function(){d.call(this)},_setPos:function(f){s.call(this,f),this._applyRotation()},_applyRotation:function(){this.options.rotationAngle&&(this._icon.style[L.DomUtil.TRANSFORM+"Origin"]=this.options.rotationOrigin,h?this._icon.style[L.DomUtil.TRANSFORM]="rotate("+this.options.rotationAngle+"deg)":this._icon.style[L.DomUtil.TRANSFORM]+=" rotateZ("+this.options.rotationAngle+"deg)")},setRotationAngle:function(f){return this.options.rotationAngle=f,this.update(),this},setRotationOrigin:function(f){return this.options.rotationOrigin=f,this.update(),this}}),t.Symbol=t.Symbol||{},t.Symbol.Dash=t.Class.extend({options:{pixelSize:10,pathOptions:{}},initialize:function(s){t.Util.setOptions(this,s),this.options.pathOptions.clickable=!1},buildSymbol:function(s,h,f,C,O){var w=this.options,Y=Math.PI/180;if(w.pixelSize<=1)return t.polyline([s.latLng,s.latLng],w.pathOptions);var G=f.project(s.latLng),$=-(s.heading-90)*Y,E=t.point(G.x+w.pixelSize*Math.cos($+Math.PI)/2,G.y+w.pixelSize*Math.sin($)/2),N=G.add(G.subtract(E));return t.polyline([f.unproject(E),f.unproject(N)],w.pathOptions)}}),t.Symbol.dash=function(d){return new t.Symbol.Dash(d)},t.Symbol.ArrowHead=t.Class.extend({options:{polygon:!0,pixelSize:10,headAngle:60,pathOptions:{stroke:!1,weight:2}},initialize:function(s){t.Util.setOptions(this,s),this.options.pathOptions.clickable=!1},buildSymbol:function(s,h,f,C,O){return this.options.polygon?t.polygon(this._buildArrowPath(s,f),this.options.pathOptions):t.polyline(this._buildArrowPath(s,f),this.options.pathOptions)},_buildArrowPath:function(s,h){var f=Math.PI/180,C=h.project(s.latLng),O=-(s.heading-90)*f,w=this.options.headAngle/2*f,Y=O+w,G=O-w,$=t.point(C.x-this.options.pixelSize*Math.cos(Y),C.y+this.options.pixelSize*Math.sin(Y)),E=t.point(C.x-this.options.pixelSize*Math.cos(G),C.y+this.options.pixelSize*Math.sin(G));return[h.unproject($),s.latLng,h.unproject(E)]}}),t.Symbol.arrowHead=function(d){return new t.Symbol.ArrowHead(d)},t.Symbol.Marker=t.Class.extend({options:{markerOptions:{},rotate:!1},initialize:function(s){t.Util.setOptions(this,s),this.options.markerOptions.clickable=!1,this.options.markerOptions.draggable=!1},buildSymbol:function(s,h,f,C,O){return this.options.rotate&&(this.options.markerOptions.rotationAngle=s.heading+(this.options.angleCorrection||0)),t.marker(s.latLng,this.options.markerOptions)}}),t.Symbol.marker=function(d){return new t.Symbol.Marker(d)};var J=function(s){return Array.isArray(s)&&function(s){return s instanceof t.LatLng||Array.isArray(s)&&2===s.length&&"number"==typeof s[0]}(s[0])};t.PolylineDecorator=t.FeatureGroup.extend({options:{patterns:[]},initialize:function(s,h){t.FeatureGroup.prototype.initialize.call(this),t.Util.setOptions(this,h),this._map=null,this._paths=this._initPaths(s),this._bounds=this._initBounds(),this._patterns=this._initPatterns(this.options.patterns)},_initPaths:function(s,h){var f=this;return J(s)?[h?s.concat([s[0]]):s]:s instanceof t.Polyline?this._initPaths(s.getLatLngs(),s instanceof t.Polygon):Array.isArray(s)?s.reduce(function(O,w){return O.concat(f._initPaths(w,h))},[]):[]},_initPatterns:function(s){return s.map(this._parsePatternDef)},setPatterns:function(s){this.options.patterns=s,this._patterns=this._initPatterns(this.options.patterns),this.redraw()},setPaths:function(s){this._paths=this._initPaths(s),this._bounds=this._initBounds(),this.redraw()},_parsePatternDef:function(s,h){return{symbolFactory:s.symbol,offset:F(s.offset),endOffset:F(s.endOffset),repeat:F(s.repeat)}},onAdd:function(s){this._map=s,this._draw(),this._map.on("moveend",this.redraw,this)},onRemove:function(s){this._map.off("moveend",this.redraw,this),this._map=null,t.FeatureGroup.prototype.onRemove.call(this,s)},_initBounds:function(){var s=this._paths.reduce(function(h,f){return h.concat(f)},[]);return t.latLngBounds(s)},getBounds:function(){return this._bounds},_buildSymbols:function(s,h,f){var C=this;return f.map(function(O,w){return h.buildSymbol(O,s,C._map,w,f.length)})},_getDirectionPoints:function(s,h){var f=this;return s.length<2?[]:function n(d,s){var h=x(d),f=h.length;if(0===f)return[];var C=h[f-1].distB,O=T(s.offset,C),w=T(s.endOffset,C),G=C*T(s.repeat,C),E=w>0?C*w:0,N=[],Q=O>0?C*O:0;do{N.push(Q),Q+=G}while(G>0&&Q<C-E);var R=0,B=h[0];return N.map(function(r){for(;r>B.distB&&R<f-1;)R++,B=h[R];return{pt:p(B.a,B.b,(r-B.distA)/(B.distB-B.distA)),heading:B.heading}})}(s.map(function(O){return f._map.project(O)}),h).map(function(O){return{latLng:f._map.unproject(t.point(O.pt)),heading:O.heading}})},redraw:function(){!this._map||(this.clearLayers(),this._draw())},_getPatternLayers:function(s){var h=this,f=this._map.getBounds().pad(.1);return this._paths.map(function(C){var O=h._getDirectionPoints(C,s).filter(function(w){return f.contains(w.latLng)});return t.featureGroup(h._buildSymbols(C,s.symbolFactory,O))})},_draw:function(){var s=this;this._patterns.map(function(h){return s._getPatternLayers(h)}).forEach(function(h){s.addLayer(t.featureGroup(h))})}}),t.polylineDecorator=function(d,s){return new t.PolylineDecorator(d,s)}}(a(8407))}}]);